<!DOCTYPE html>
<html>
<head>
  <title>맛집 추천</title>
  <style>
    #map { height: 400px; width: 100%; }
    body { font-family: Arial, sans-serif; }
  </style>
</head>
<body>
    <h1>내 맛집 추천</h1>
    <input type="text" id="searchInput" placeholder="식당 이름 검색" style="margin: 10px;">
    <button onclick="searchRestaurant()">검색</button>
    <div id="map"></div>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB2cf3YWzGrwU9WXlKGVVLFi73cnZ99Cd0&callback=initMap" async defer></script>
  <script>
    function initMap() {
      const center = { lat: 37.5172, lng: 127.0473 }; // 강남역 중심
      const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 14,
        center: center,
      });

      const restaurants = [
        { name: "고기집", lat: 37.5172, lng: 127.0473, revisitIntent: 90, revisitRate: 80 },
        { name: "파스타 맛집", lat: 37.5200, lng: 127.0450, revisitIntent: 85, revisitRate: 70 },
        { name: "카페 드림", lat: 37.5150, lng: 127.0500, revisitIntent: 95, revisitRate: 85 },
        { name: "분식 천국", lat: 37.5180, lng: 127.0400, revisitIntent: 80, revisitRate: 65 },
        { name: "초밥 왕", lat: 37.5140, lng: 127.0480, revisitIntent: 88, revisitRate: 75 },
      ];

      restaurants.forEach(restaurant => {
  const markerColor = restaurant.revisitRate >= 80 ? "http://maps.google.com/mapfiles/ms/icons/green-dot.png" :
                     restaurant.revisitRate <= 60 ? "http://maps.google.com/mapfiles/ms/icons/red-dot.png" :
                     "http://maps.google.com/mapfiles/ms/icons/yellow-dot.png";
  const marker = new google.maps.Marker({
    position: { lat: restaurant.lat, lng: restaurant.lng },
    map: map,
    title: restaurant.name,
    icon: markerColor,
  });
  const infoWindow = new google.maps.InfoWindow({
    content: `<b>${restaurant.name}</b><br>재방문의사: ${restaurant.revisitIntent}%<br>재방문율: ${restaurant.revisitRate}%`,
  });
  marker.addListener("click", () => infoWindow.open(map, marker));
});
    }
    function searchRestaurant() {
      const input = document.getElementById("searchInput").value.toLowerCase();
      const found = restaurants.find(r => r.name.toLowerCase().includes(input));
      if (found) {
        map.setCenter({ lat: found.lat, lng: found.lng });
        map.setZoom(16);
        alert(`${found.name} 찾았어요!`);
      } else {
        alert("검색 결과가 없어요.");
      }
    }
  </script>
</body>
</html>